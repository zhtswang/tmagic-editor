{"version":3,"mappings":"2EAAA,KAAM,GAAY,gBAAsB,EAAO,CAAE,EAAO,EAAO,2CAAwD,EAAgB,SAAiB,EAAY,EAAM,CAEtK,MAAI,CAAwB,GAAQ,EAAK,SAAW,EACzC,EAAU,EAEd,QAAQ,IAAI,EAAK,IAAI,CAAC,EAAQ,CAIjC,GAFA,EAAM,GAAG,IAAO,IAEZ,IAAO,GACP,OAEJ,EAAK,GAAO,GACZ,KAAM,GAAQ,EAAI,SAAS,MAAM,EAC3B,EAAc,EAAQ,qBAAuB,GAEnD,GAAI,SAAS,cAAc,cAAc,MAAQ,GAAa,EAC1D,OAGJ,KAAM,GAAO,SAAS,cAAc,MAAM,EAU1C,GARA,EAAK,IAAM,EAAQ,aAAe,EAC7B,GACD,GAAK,GAAK,SACV,EAAK,YAAc,IAEvB,EAAK,KAAO,EAEZ,SAAS,KAAK,YAAY,CAAI,EAC1B,EACA,MAAO,IAAI,SAAQ,CAAC,EAAK,IAAQ,CAC7B,EAAK,iBAAiB,OAAQ,CAAG,EACjC,EAAK,iBAAiB,QAAS,IAAM,EAAI,GAAI,OAAM,6BAA6B,GAAK,CAAC,CAAC,CACvG,CAAa,CAER,EAAC,EAAE,KAAK,IAAM,EAAY,EAC/B,ECXA,YAAe,SACP,QAAMA,qBAA6B,CAAU,EAE/C,IAAC,qBAAK,OAAL,QAAW,MACP,YAGH,QAAc,EAAI,iBAAiB,MAAM,EAE/C,MAAQ,oBAAY,OAAQ,oBAAK,OAAL,cAAW,KAAc,CACvD,CCPA,uGAAwB,KAAK,IAAM,OAC3B,MAAE,cAAe,OAAO,sBAExB,EAAM,GAAIC,GAAK,CACnB,OAAQ,CAAC,EACT,QAAS,EAAY,MAAM,EAC5B,EAED,GAAI,GAAY,GAEV,QAAe,CAAC,EAAe,CACnC,WAAK,UAAU,GACL,KAGN,EAAY,IAAM,CACtB,EAAS,OACN,kBAAM,WAAN,KACC,gBAAC,EAAW,SAAX,CAAoB,MAAO,GAC1B,gBAAC,MAAI,CACP,CACF,EACA,SAAS,eAAe,MAAM,CAChC,EAEA,WAAW,IAAM,CAEf,OAAO,MAAM,eAAe,SAAS,cAAc,gBAAgB,CAAC,EACrE,GAGG,EAAa,CACjB,QAAS,CACA,QACT,EAEA,iBAAiB,EAAY,CACnB,YAAI,qBAAsB,CAAI,EACtC,WAAK,UAAU,EACjB,EAEA,aAAa,EAAY,CACf,YAAI,iBAAkB,CAAE,EACpB,IACZ,WAAK,QAAQ,GACH,GACZ,EAEA,6BAA8B,CACrB,6BACT,EAEA,OAAO,EAAY,CACT,YAAI,gBAAiB,CAAE,EACzB,QAAK,SAAS,eAAe,CAAE,EACjC,UAEG,GAAI,SAAQ,CAAC,EAAY,CAC9B,WAAW,IAAM,CACP,WAAS,eAAe,CAAE,CAAC,GAClC,CAAC,EACL,CACH,EAEA,IAAI,CAAE,QAAoB,CAChB,YAAI,aAAc,CAAI,EAC9B,EAAa,CAAI,CACnB,EAEA,OAAO,CAAE,QAAoB,CACnB,YAAI,gBAAiB,CAAI,EACjC,EAAa,CAAI,CACnB,EAEA,SAAS,CAAE,QAAuB,CACxB,YAAI,cAAe,CAAI,EAC/B,EAAa,CAAI,CACnB,EAEA,OAAO,CAAE,QAAoB,CACnB,YAAI,gBAAiB,CAAI,EACjC,EAAa,CAAI,CACnB,GAGK,YAAK,CAAU,EAAE,QAAQ,CAAC,EAAiB,EAAI,kBAAkB,EAAM,EAAW,EAAK,CAAC,EAGxF,0BAAO,eAAe,EAC/B,CAAC","names":["useContext","Core"],"sources":["../../vite/preload-helper","../../src/playground/App.tsx","../../src/playground/main.tsx"],"sourcesContent":["const scriptRel = 'modulepreload';const seen = {};const base = '/tmagic-editor/playground/runtime/react/';export const __vitePreload = function preload(baseModule, deps) {\n    // @ts-ignore\n    if (!__VITE_IS_MODERN__ || !deps || deps.length === 0) {\n        return baseModule();\n    }\n    return Promise.all(deps.map((dep) => {\n        // @ts-ignore\n        dep = `${base}${dep}`;\n        // @ts-ignore\n        if (dep in seen)\n            return;\n        // @ts-ignore\n        seen[dep] = true;\n        const isCss = dep.endsWith('.css');\n        const cssSelector = isCss ? '[rel=\"stylesheet\"]' : '';\n        // @ts-ignore check if the file is already preloaded by SSR markup\n        if (document.querySelector(`link[href=\"${dep}\"]${cssSelector}`)) {\n            return;\n        }\n        // @ts-ignore\n        const link = document.createElement('link');\n        // @ts-ignore\n        link.rel = isCss ? 'stylesheet' : scriptRel;\n        if (!isCss) {\n            link.as = 'script';\n            link.crossOrigin = '';\n        }\n        link.href = dep;\n        // @ts-ignore\n        document.head.appendChild(link);\n        if (isCss) {\n            return new Promise((res, rej) => {\n                link.addEventListener('load', res);\n                link.addEventListener('error', () => rej(new Error(`Unable to preload CSS for ${dep}`)));\n            });\n        }\n    })).then(() => baseModule());\n}","/*\n * Tencent is pleased to support the open source community by making TMagicEditor available.\n *\n * Copyright (C) 2021 THL A29 Limited, a Tencent company.  All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useContext } from 'react';\n\nimport Core from '@tmagic/core';\nimport type { Page } from '@tmagic/schema';\nimport { AppContent } from '@tmagic/ui-react';\n\nimport './App.css';\n\nfunction App() {\n  const app = useContext<Core | undefined>(AppContent);\n\n  if (!app?.page?.data) {\n    return null;\n  }\n\n  const MagicUiPage = app.resolveComponent('page');\n\n  return <MagicUiPage config={app?.page?.data as Page}></MagicUiPage>;\n}\n\nexport default App;\n","/*\n * Tencent is pleased to support the open source community by making TMagicEditor available.\n *\n * Copyright (C) 2021 THL A29 Limited, a Tencent company.  All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport Core from '@tmagic/core';\nimport type { MApp } from '@tmagic/schema';\nimport type { RemoveData, SortEventData, UpdateData } from '@tmagic/stage';\nimport { AppContent } from '@tmagic/ui-react';\nimport { getUrlParam } from '@tmagic/utils';\n\nimport App from './App';\n\nimport('../comp-entry').then(() => {\n  const { components } = window.magicPresetComponents;\n\n  const app = new Core({\n    config: {},\n    curPage: getUrlParam('page'),\n  });\n\n  let curPageId = '';\n\n  const updateConfig = (root: MApp) => {\n    app?.setConfig(root);\n    renderDom();\n  };\n\n  const renderDom = () => {\n    ReactDOM.render(\n      <React.StrictMode>\n        <AppContent.Provider value={app}>\n          <App />\n        </AppContent.Provider>\n      </React.StrictMode>,\n      document.getElementById('root'),\n    );\n\n    setTimeout(() => {\n      // @ts-ignore\n      window.magic.onPageElUpdate(document.querySelector('.magic-ui-page'));\n    });\n  };\n\n  const operations = {\n    getApp() {\n      return app;\n    },\n\n    updateRootConfig(root: MApp) {\n      console.log('update root config', root);\n      app?.setConfig(root);\n    },\n\n    updatePageId(id: string) {\n      console.log('update page id', id);\n      curPageId = id;\n      app?.setPage(curPageId);\n      renderDom();\n    },\n\n    getSnapElementQuerySelector() {\n      return '[class*=magic-ui][id]';\n    },\n\n    select(id: string) {\n      console.log('select config', id);\n      const el = document.getElementById(id);\n      if (el) return el;\n      // 未在当前文档下找到目标元素，可能是还未渲染，等待渲染完成后再尝试获取\n      return new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(document.getElementById(id));\n        }, 0);\n      });\n    },\n\n    add({ root }: UpdateData) {\n      console.log('add config', root);\n      updateConfig(root);\n    },\n\n    update({ root }: UpdateData) {\n      console.log('update config', root);\n      updateConfig(root);\n    },\n\n    sortNode({ root }: SortEventData) {\n      console.log('sort config', root);\n      updateConfig(root);\n    },\n\n    remove({ root }: RemoveData) {\n      console.log('remove config', root);\n      updateConfig(root);\n    },\n  };\n\n  Object.keys(components).forEach((type: string) => app.registerComponent(type, components[type]));\n\n  // @ts-ignore\n  window.magic?.onRuntimeReady(operations);\n});\n"],"file":"assets/playground.js"}